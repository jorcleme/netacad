# Simple test container - just runs sanity tests
FROM python:3.12-slim-bookworm AS test

WORKDIR /app

# Install test dependencies only
COPY tests/test_requirements.txt /app/tests/test_requirements.txt
RUN pip install --no-cache-dir -r /app/tests/test_requirements.txt

# Copy tests only
COPY tests/ /app/tests/

ENV PYTHONUNBUFFERED=1

# Run tests and generate reports
# Use nosetests.xml for compatibility with Jenkins expectations
ENTRYPOINT ["pytest", "tests/", "-v", "--junitxml=nosetests.xml", "--tb=short"]